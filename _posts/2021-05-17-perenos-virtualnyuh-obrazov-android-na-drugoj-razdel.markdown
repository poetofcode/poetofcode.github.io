---
layout: post
title: "Перенос виртуальных образов Android на другой раздел"
date: 2021-05-17 11:46:01 +0300
comments: true
category:
tags: [android, из-рабочего]
image: /images/android/move_avd/poster.png
---

В моей конфигурации рабочей машины есть два основных диска: быстрый SSD, но скромных размеров (240 GB) и медленный HDD, но большой (1 Тб). По современным меркам это негусто, но мне пока хватает. Однако, Android-разработка в силу своей фрагментированности требует для отладки наличия сразу нескольких установленных образов эмуляторов с разными версиями Android'а, соответственно.

> Если ты Android-разработчик - ты не покупаешь новые телефоны, когда они выходят...ты их скачиваешь.

На данный момент разработчикам приходится обеспечивать обратную совместимость своего приложения вплоть до Android 4.4 KitKat (Api 19). Например, мой список девайсов выглядит примерно так:

![Список AVD](/images/android/move_avd/avd_list.png)

## Куда сохраняются образы физически?

При установке Android Studio вы указываете установочный путь для `SDK`. Виртуальные образы при загрузке и установке хранятся в подкаталоге `system-images`. В моём случае это директория: `C:\android_sdk_tools\sdk\system-images`.

На скрине показано её содержимое и сколько всё это весит. В правом окне открыт диск `f` и директория `android_sys_img`, куда мы будем всё это хозяйство переносить:

![Каталог SDK](/images/android/move_avd/explorer.png)

## Где взять путь к SDK и сам перенос

Путь к вашему SDK будет отличаться от моего. Узнать его всегда можно в настройках студии, в разделе:

```
Appearence & Behavior -> System Settings -> Android SDK -> Android SDK Location
```

Показано на скрине:

![Список AVD](/images/android/move_avd/sdk_path.png)

Займёмся переносом каталога `C:\android_sdk_tools\sdk\system-images` в `F:\android_sys_img`. Для этого нужно будет выполнить два шага:

1. Перемещение содержимого каталога `C:\android_sdk_tools\sdk\system-images` в директорию `F:\android_sys_img\`

2. Создание символической ссылки командой `mklink /d C:\android_sdk_tools\sdk\system-images f:\android_sys_img` для Windows. CMD при этом должен быть запущен в режиме Администратора (аналогичная команда для Unix-подобных система: `ln -s`: [Create a symbolic link in Unix](https://kb.iu.edu/d/abbe)).

На скрине приведён запуск и результат создания sym-link'а на один из имеющихся у меня AVD:

![Создание символической ссылки](/images/android/move_avd/symlink.png)

Если всё выполнено корректно, то эмуляторы будут по-прежнему запускаться и работать.